---

- name: rabbit1 delete
  shell: docker rm -f node1
  ignore_errors: yes
- name: rabbit2 delete
  shell: docker rm -f node2
  ignore_errors: yes
- name: rabbit3 delete
  shell: docker rm -f node3
  ignore_errors: yes

- name: node1 CLuster
  shell: docker run -d \
    --name node1 \
    --network="mynet" \
    --hostname node1 \
    --publish 5672:5672 --publish 15672:15672 \
    --env ERLANG_COOKIE=abcdefg --env RABBITMQ_USERNAME=behnam --env RABBITMQ_PASSWORD=behnam \
    bitnami/rabbitmq:latest

- name: node2 CLuster
  shell: docker run -d \
    --name node2 \
    --network="mynet" \
    --hostname node2 \
    --publish 5673:5673 --publish 15673:15673 \
    --env ERLANG_COOKIE=abcdefg --env  CLUSTER_WITH=node1  --env ENABLE_RAM=true  --env RAM_NODE=true --env RABBITMQ_USERNAME=behnam --env RABBITMQ_PASSWORD=behnam \
    bitnami/rabbitmq:latest

- name: node3 CLuster
  shell: docker run -d \
    --name node3 \
    --network="mynet" \
    --hostname node3 \
    --publish 5674:5674 --publish 15674:15674 \
    --env ERLANG_COOKIE=abcdefg --env  CLUSTER_WITH=node1  --env ENABLE_RAM=true  --env RAM_NODE=true --env RABBITMQ_USERNAME=behnam --env RABBITMQ_PASSWORD=behnam \
    bitnami/rabbitmq:latest
